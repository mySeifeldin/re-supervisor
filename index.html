<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AIP | Down Town Experience</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@300;700&display=swap');
        :root { --aip-blue: #3b82f6; --dark-bg: #020617; }
        body { background: var(--dark-bg); color: #f8fafc; font-family: 'Cairo', sans-serif; overflow: hidden; height: 100vh; }
        .glass { background: rgba(15, 23, 42, 0.8); backdrop-filter: blur(25px); border: 1px solid rgba(255,255,255,0.1); }
        
        /* Presentation Animation */
        #presentation-layer { position: fixed; inset: 0; z-index: 150; background: var(--dark-bg); display: flex; align-items: center; justify-content: center; transition: all 1s ease; }
        .hero-slide { position: absolute; inset: 0; opacity: 0; transition: opacity 1.5s ease; background-size: cover; background-position: center; }
        .hero-slide.active { opacity: 0.4; }
        .present-text { position: relative; z-index: 160; text-align: center; transform: translateY(30px); opacity: 0; transition: all 1s ease; }
        .present-text.active { transform: translateY(0); opacity: 1; }

        /* Chat Styles */
        .ai-bubble { background: rgba(30, 41, 59, 0.7); border-right: 4px solid var(--aip-blue); white-space: pre-line; }
        .wa-float { position: fixed; bottom: 100px; left: 20px; z-index: 200; display: none; }
        .img-card { flex: 0 0 auto; width: 200px; height: 120px; border-radius: 1rem; overflow: hidden; border: 2px solid rgba(59, 130, 246, 0.3); }
        
        @keyframes slideUp { from { transform: translateY(100%); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        .animate-slide { animation: slideUp 0.8s ease forwards; }
    </style>
</head>
<body class="flex flex-col h-screen">

    <div id="presentation-layer">
        <div id="slides-container"></div>
        <div class="present-text" id="present-info">
            <h1 class="text-4xl font-black mb-4 text-blue-500">DOWN TOWN MANSOURA</h1>
            <p class="text-xl text-slate-300 mb-8" id="dynamic-text">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ ØªØ¬Ø±Ø¨Ø© Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ...</p>
            <button onclick="skipToChat()" class="px-8 py-3 bg-blue-600 rounded-full font-bold animate-pulse">Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø© Ø§Ù„Ø¢Ù†</button>
        </div>
    </div>

    <main id="main-ui" class="flex-1 flex flex-col p-4 opacity-0 transition-opacity duration-1000">
        <header class="flex justify-between items-center mb-4">
            <div>
                <h1 class="text-xl font-black text-blue-500">AIP <span class="text-white opacity-20">CLIENT</span></h1>
                <p class="text-[8px] uppercase tracking-widest text-slate-500">Al-Temamy Official Intelligence</p>
            </div>
            <button onclick="window.open('https://wa.me/201000000000')" class="w-10 h-10 bg-green-600 rounded-full flex items-center justify-center shadow-lg"><i class="fab fa-whatsapp text-xl"></i></button>
        </header>

        <div class="flex-1 glass rounded-[2rem] p-4 mb-4 flex flex-col overflow-hidden">
            <div id="chat-box" class="flex-1 overflow-y-auto space-y-4 mb-4 pr-1 scroll-smooth"></div>
            
            <div id="quick-replies" class="flex gap-2 overflow-x-auto pb-2">
                <button onclick="sendQuickMsg('ğŸ“ Ø§Ù„Ù…ÙˆÙ‚Ø¹')" class="whitespace-nowrap bg-slate-800 border border-blue-500/20 px-4 py-2 rounded-full text-xs">ğŸ“ Ø§Ù„Ù…ÙˆÙ‚Ø¹</button>
                <button onclick="sendQuickMsg('ğŸ—ï¸ Ø³Ø§Ø¨Ù‚Ø© Ø§Ù„Ø£Ø¹Ù…Ø§Ù„')" class="whitespace-nowrap bg-slate-800 border border-blue-500/20 px-4 py-2 rounded-full text-xs">ğŸ—ï¸ Ø³Ø§Ø¨Ù‚Ø© Ø§Ù„Ø£Ø¹Ù…Ø§Ù„</button>
                <button onclick="sendQuickMsg('Ø£Ø±ÙŠØ¯ Ø­Ø¬Ø² ÙˆØ­Ø¯Ø© (Ø¥Ø­Ø¬Ø² Ø§Ù„Ø¢Ù†)')" class="whitespace-nowrap bg-blue-600 px-4 py-2 rounded-full text-xs font-bold">ğŸ’ Ø¥Ø­Ø¬Ø² Ø§Ù„Ø¢Ù†</button>
            </div>

            <div class="flex gap-2 items-center bg-slate-950 p-2 rounded-2xl">
                <input type="text" id="user-input" class="flex-1 bg-transparent px-2 text-sm outline-none" placeholder="Ø§Ø³Ø£Ù„ ÙƒÙŠÙ…Ùˆ Ø¹Ù† ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹...">
                <button onclick="sendMessage()" class="bg-blue-600 w-10 h-10 rounded-xl flex items-center justify-center"><i class="fas fa-paper-plane"></i></button>
            </div>
        </div>

        <div id="media-content" class="flex gap-3 overflow-x-auto py-2"></div>
    </main>

    <a id="wa-referral" href="https://wa.me/201000000000" target="_blank" class="wa-float w-16 h-16 bg-green-600 rounded-full flex items-center justify-center shadow-2xl animate-bounce">
        <i class="fab fa-whatsapp text-3xl text-white"></i>
    </a>

    <script>
        const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxHQwlvc8o-6MwCH_UgrJVn9QPlQULQl-Yb7F8GdLB6i2RbZDikYScG54j7yjFfeP0LHA/exec";
        const introImages = [
            "https://images.unsplash.com/photo-1486406146926-c627a92ad1ab?q=80&w=2070", // ØµÙˆØ±Ø© ØªØ¬Ø±ÙŠØ¨ÙŠØ©
            "https://images.unsplash.com/photo-1497366216548-37526070297c?q=80&w=2069"
        ];
        const introTexts = [
            "Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ø¯Ø§ÙˆÙ† ØªØ§ÙˆÙ† Ø§Ù„Ù…Ù†ØµÙˆØ±Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©",
            "Ø§Ø³ØªØ«Ù…Ø§Ø±Ùƒ Ø§Ù„Ø£ÙˆÙ„ Ù…Ø¹ Ø´Ø±ÙƒØ© Ø§Ù„ØªÙ…Ø§Ù…ÙŠ ÙˆØ£ØµÙŠÙ„",
            "Ù…ÙˆÙ‚Ø¹ Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠ Ø£Ù…Ø§Ù… Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø¨Ù†ÙˆÙƒ ÙˆØ§Ù„Ø¬Ø§Ù…Ø¹Ø§Øª",
            "Ø£Ù†Ø§ ÙƒÙŠÙ…Ùˆ.. Ù…Ø³ØªØ´Ø§Ø±Ùƒ Ø§Ù„Ø°ÙƒÙŠ.. ÙƒÙŠÙ ÙŠÙ…ÙƒÙ†Ù†ÙŠ Ù…Ø³Ø§Ø¹Ø¯ØªÙƒØŸ"
        ];

        let currentSlide = 0;

        function startPresentation() {
            const container = document.getElementById('slides-container');
            container.innerHTML = introImages.map((src, i) => `<div class="hero-slide ${i===0?'active':''}" style="background-image:url('${src}')"></div>`).join('');
            
            let textIdx = 0;
            const textElement = document.getElementById('dynamic-text');
            const presentDiv = document.getElementById('present-info');
            
            presentDiv.classList.add('active');

            const interval = setInterval(() => {
                textElement.innerText = introTexts[textIdx];
                document.querySelectorAll('.hero-slide').forEach((s, i) => s.classList.toggle('active', i === (textIdx % introImages.length)));
                textIdx++;
                if(textIdx >= introTexts.length) {
                    clearInterval(interval);
                    setTimeout(skipToChat, 2000);
                }
            }, 3000);
        }

        function skipToChat() {
            document.getElementById('presentation-layer').style.transform = "translateY(-100%)";
            document.getElementById('main-ui').classList.remove('hidden');
            setTimeout(() => {
                document.getElementById('main-ui').classList.add('opacity-100');
                appendMessage("ÙƒÙŠÙ…Ùˆ", "Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ ÙŠØ§ ÙÙ†Ø¯Ù… ÙÙŠ Down Town Ø§Ù„Ù…Ù†ØµÙˆØ±Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©. \nØ£Ù†Ø§ ÙƒÙŠÙ…Ùˆ ÙˆÙ…ÙˆØ¬ÙˆØ¯ Ù„Ù…Ø³Ø§Ø¹Ø¯Ø© Ø­Ø¶Ø±ØªÙƒ ÙÙŠ Ø§Ø®ØªÙŠØ§Ø± Ø£ÙØ¶Ù„ Ø§Ø³ØªØ«Ù…Ø§Ø± ØªØ¬Ø§Ø±ÙŠ Ø£Ùˆ Ø¥Ø¯Ø§Ø±ÙŠ. \nØ§ØªØ´Ø±Ù Ø¨Ø§Ø³Ù… Ø­Ø¶Ø±ØªÙƒØŸ", "ai");
            }, 1000);
        }

        async function apiCall(msg) {
            showLoading(true);
            const response = await fetch(SCRIPT_URL, {
                method: "POST",
                body: JSON.stringify({ action: "clientAssistant", message: msg, history: "", platformId: "web-" + Date.now() })
            });
            const data = await response.json();
            showLoading(false);
            
            if(data.reply) {
                // ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ø±Ø¯ Ø¨Ø£Ø³Ø·Ø± Ø¬Ø¯ÙŠØ¯Ø© Ø¹Ù†Ø¯ Ø§Ù„Ù†Ù‚Ø·Ø©
                const formattedReply = data.reply.replace(/\./g, ".\n");
                appendMessage("ÙƒÙŠÙ…Ùˆ", formattedReply, "ai");
                if(data.redirectToWA) document.getElementById('wa-referral').style.display = "flex";
            }
            if(data.media) updateMedia(data.media);
        }

        function appendMessage(sender, text, type) {
            const chatBox = document.getElementById('chat-box');
            chatBox.innerHTML += `<div class="p-4 rounded-2xl ${type === 'user' ? 'bg-blue-600 ml-8' : 'ai-bubble mr-8'} animate-slide">
                <p class="text-sm">${text}</p></div>`;
            chatBox.scrollTop = chatBox.scrollHeight;
        }

        function updateMedia(images) {
            const content = document.getElementById('media-content');
            content.innerHTML = images.map(img => `<div class="img-card"><img src="${img}" class="w-full h-full object-cover"></div>`).join('');
        }

        function showLoading(show) {
            const chatBox = document.getElementById('chat-box');
            if(show) chatBox.innerHTML += `<div id="loader" class="p-2 text-xs text-blue-400">ÙƒÙŠÙ…Ùˆ ÙŠÙƒØªØ¨ Ø§Ù„Ø¢Ù†...</div>`;
            else { const l = document.getElementById('loader'); l && l.remove(); }
        }

        window.onload = startPresentation;
    </script>
</body>
</html>
